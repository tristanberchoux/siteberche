<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.54.0" />

  <title>Marie Curie says stop hating on quilt plots already. &middot; Tristan&#39;s website</title>

  
  
  <link rel="stylesheet" href="https://cdn.bootcss.com/pure/0.6.2/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdn.bootcss.com/pure/0.6.2/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="/css/blackburn.css">

  <link rel="stylesheet" href="/css/github-gist.css" rel="stylesheet" id="theme-stylesheet">
  <script src="/js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  
  <script async src="https://use.fontawesome.com/32c3d13def.js"></script>

  
  

  
  <link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.11.0/styles/github.min.css">
  <script src="//cdn.bootcss.com/highlight.js/9.11.0/highlight.min.js"></script>
  <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/r.min.js"></script>
  <script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="/"><img src="/img/ciheam.png" alt="CIHEAM" /></a>



  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/teaching/"><i class='fa fa-university fa-fw'></i>Teaching</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/research/"><i class='fa fa-area-chart fa-fw'></i>Research</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/papers/"><i class='fa fa-newspaper-o fa-fw'></i>Publications</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="mailto:tristan.berchoux@gmail.com" target="_blank"><i class="fa fa-envelope fa-fw"></i>Email</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/tristanberchoux" target="_blank"><i class="fa fa-linkedin-square fa-fw"></i>LinkedIn</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/TristanBerchoux" target="_blank"><i class="fa fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://www.researchgate.net/profile/Tristan_Berchoux" target="_blank"><i class="fa fa-flask fa-fw"></i>ResearchGate</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://scholar.google.co.uk/citations?user=shdhPjcAAAAJ%26hl%3den" target="_blank"><i class="fa fa-graduation-cap fa-fw"></i>Scholar</a>
    </li>
    


    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="http://orcid.org/0000-0003-4095-2164" target="_blank"><i class="fa fa-id-badge fa-fw"></i>ORCID</a>
    </li>
    


    


  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2019 by Tristan Berchoux</small>
  </div>
  <div class="small-print">
    <small>Built with <a href="https://github.com/rstudio/blogdown" target="_blank">blogdown</a> and <a href="https://gohugo.io/" target="_blank">Hugo</a>. Theme <a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a>.</small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Marie Curie says stop hating on quilt plots already.</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    
    <i class="fa fa-user fa-fw"></i>
    <span>Jeff Leek</span>
    
    <i class="fa fa-calendar fa-fw"></i>
    <time>2014/01/28</time>
  </div>

  

  

  

</div>


  <blockquote>
<p>&ldquo;There are sadistic scientists who hurry to hunt down error instead of establishing the truth.&rdquo; -Marie Curie (<a href="http://en.wikiquote.org/wiki/Marie_Curie">http://en.wikiquote.org/wiki/Marie_Curie</a>)</p>
</blockquote>

<p>Thanks to Kasper H. for that quote. I think it is a perfect fit for today&rsquo;s culture of academic put down as academic contribution. One perfect example is the explosion of hate against the quilt plot. A quilt plot is a heatmap with several parameters selected in advance; that&rsquo;s it. <a href="http://www.plosone.org/article/info%3Adoi%2F10.1371%2Fjournal.pone.0085047">This simplification</a> of R&rsquo;s heatmap function appeared in the journal PLoS One. They say (though not up front and not clearly enough for my personal taste) that they know it is just a heatmap.</p>

<p>Over the course of the next several weeks quilt plots went viral. Here <a href="https://twitter.com/EvolOdonata/status/427657216154664960">are a</a> <a href="https://twitter.com/BioMickWatson/status/426780957279281152">few</a> <a href="https://twitter.com/rvimieiro/status/423418772368547840">example</a> tweets. It was also [&gt; &ldquo;There are sadistic scientists who hurry to hunt down error instead of establishing the truth.&rdquo; -Marie Curie (<a href="http://en.wikiquote.org/wiki/Marie_Curie">http://en.wikiquote.org/wiki/Marie_Curie</a>)</p>

<p>Thanks to Kasper H. for that quote. I think it is a perfect fit for today&rsquo;s culture of academic put down as academic contribution. One perfect example is the explosion of hate against the quilt plot. A quilt plot is a heatmap with several parameters selected in advance; that&rsquo;s it. <a href="http://www.plosone.org/article/info%3Adoi%2F10.1371%2Fjournal.pone.0085047">This simplification</a> of R&rsquo;s heatmap function appeared in the journal PLoS One. They say (though not up front and not clearly enough for my personal taste) that they know it is just a heatmap.</p>

<p>Over the course of the next several weeks quilt plots went viral. Here <a href="https://twitter.com/EvolOdonata/status/427657216154664960">are a</a> <a href="https://twitter.com/BioMickWatson/status/426780957279281152">few</a> <a href="https://twitter.com/rvimieiro/status/423418772368547840">example</a> tweets. It was also](<a href="http://liorpachter.wordpress.com/2014/01/19/why-do-you-look-at-the-speck-in-your-sisters-quilt-plot-and-pay-no-attention-to-the-plank-in-your-own-heat-map/">http://liorpachter.wordpress.com/2014/01/19/why-do-you-look-at-the-speck-in-your-sisters-quilt-plot-and-pay-no-attention-to-the-plank-in-your-own-heat-map/</a>) on <a href="http://eagereyes.org/series/peer-review/1-quilt-plots">people&rsquo;s blogs</a> and <a href="http://www.the-scientist.com/?articles.view/articleNo/38919/title/Not-So-New-/">even in the scientist</a>. So I did an experiment. I built a table of frequencies in R like this and applied the heatmap function in R, then the quilt.plot function in fields, then the function written by the authors of the paper with as minimal tweeking as possible.</p>

<pre class="brush: r; title: ; notranslate" title="">set.seed(12345)
library(fields)
x = matrix(rbinom(25,size=4,prob=0.5),nrow=5)
pt = prop.table(x)
heatmap(pt)
quilt.plot(x=rep(1:5,5),y=rep(1:5,5),z=pt)
quilt(pt,1:5,1:5,zlabel="Proportion")
</pre>

<p>Here are the results:</p>

<p><strong>heatmap</strong></p>

<p><a href="http://simplystatistics.org/2014/01/28/marie-curie-says-stop-hating-on-quilt-plots-already/heatmap/" rel="attachment wp-att-2588"><img class="alignnone size-medium wp-image-2588" alt="heatmap" src="http://simplystatistics.org/wp-content/uploads/2014/01/heatmap-300x300.png" width="300" height="300" srcset="http://simplystatistics.org/wp-content/uploads/2014/01/heatmap-150x150.png 150w, http://simplystatistics.org/wp-content/uploads/2014/01/heatmap-300x300.png 300w, http://simplystatistics.org/wp-content/uploads/2014/01/heatmap.png 480w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>

<p><strong>quilt.plot</strong></p>

<p><a href="http://simplystatistics.org/2014/01/28/marie-curie-says-stop-hating-on-quilt-plots-already/quilt-plot/" rel="attachment wp-att-2589"><img class="alignnone size-medium wp-image-2589" alt="quilt.plot" src="http://simplystatistics.org/wp-content/uploads/2014/01/quilt.plot_-300x300.png" width="300" height="300" srcset="http://simplystatistics.org/wp-content/uploads/2014/01/quilt.plot_-150x150.png 150w, http://simplystatistics.org/wp-content/uploads/2014/01/quilt.plot_-300x300.png 300w, http://simplystatistics.org/wp-content/uploads/2014/01/quilt.plot_.png 480w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>

<p><strong>quilt</strong></p>

<p><strong><a href="http://simplystatistics.org/2014/01/28/marie-curie-says-stop-hating-on-quilt-plots-already/quilt/" rel="attachment wp-att-2590"><img class="alignnone size-medium wp-image-2590" alt="quilt" src="http://simplystatistics.org/wp-content/uploads/2014/01/quilt-300x300.png" width="300" height="300" srcset="http://simplystatistics.org/wp-content/uploads/2014/01/quilt-150x150.png 150w, http://simplystatistics.org/wp-content/uploads/2014/01/quilt-300x300.png 300w, http://simplystatistics.org/wp-content/uploads/2014/01/quilt.png 480w" sizes="(max-width: 300px) 100vw, 300px" /></a></strong></p>

<p>It is clear that out of the box and with no tinkering, the new plot makes something nicer/more interpretable. The columns/rows are where I expect and the scale is there and nicely labeled. Everyone who has ever made heatmaps in R has some bit of code that looks like this:</p>

<pre class="brush: r; title: ; notranslate" title="">image(t(bdat)[,nrow(bdat):1],col=colsb(9),breaks=quantile(as.vector(as.matrix(dat)),probs=seq(0,1,length=10)),xaxt="n",yaxt="n",xlab="",ylab="")

</pre>

<p>To hack together a heatmap in R that looks like you expect. It is a total pain. Obviously the quilt plot paper has a few flaws:</p>

<ol>
<li>It tries to introduce the quilt plot as a new idea.</li>
<li>It doesn&rsquo;t just come out and say it is a hack of the heatmap function, but tries to dance around it.</li>
<li>It produces code, but only as images in word files. I had to retype the code to make my plot.</li>
</ol>

<p>That being said here are a couple of other true things about the paper:</p>

<ol>
<li>The code works if you type it out and apply it.</li>
<li>They produced code.</li>
<li>The paper is open access.</li>
<li>The paper is correct technically.</li>
<li>The hack is useful for users with few R skills.</li>
</ol>

<p>So why exactly isn&rsquo;t it a paper? It smacks of academic elitism to claim that this isn&rsquo;t good enough because it isn&rsquo;t a &ldquo;new idea&rdquo;. Not every paper discovers radium. Some papers are better than others and that is ok. I think the quilt plot being published isn&rsquo;t a problem, maybe I don&rsquo;t like the way it is written exactly, but they do acknowledge the heat map, they do produce correct, relevant code, and it does solve a problem people actually have. That is better than a lot of papers that appear in more prestigious journals. <a href="http://www.nature.com/news/arsenic-life-bacterium-prefers-phosphorus-after-all-1.11520#/b1">Arsenic life</a> anyone?</p>

<p>I think it is useful to have a forum where people can post correct, useful, but not necessarily ground breaking results and get credit for them, even if the credit is modest. Otherwise we might miss out on useful bits of code. Frank Harrell has a <a href="http://cran.r-project.org/web/packages/Hmisc/index.html">bunch of functions</a> that tons of people use but he doesn&rsquo;t get citations, you probably have heard of the Hmisc package if you use R.</p>

<p>But did you know Karl Broman has a bunch of really useful functions in his <a href="https://github.com/kbroman/broman">personal R package</a>, <a href="https://github.com/kbroman/broman/blob/master/R/qqline2.R">qqline2</a> is great. I know Rafa has a bunch of functions he has never published because they seem &ldquo;too trivial&rdquo; but I use them all the time. Every scientist who touches code has a personal library like this. I&rsquo;m not saying the quilt plot is in that category. But I am saying that it is stupid not to have a public forum for making these functions available to other scientists. But that won&rsquo;t happen if the &ldquo;quilt plot backlash&rdquo; is what people see when they try to get published credit for simple code that solves real problems.</p>

<p>Hacks like the quilt plot can help people who aren&rsquo;t comfortable with R write reproducible scripts without having to figure out every plotting parameter. Keeping in mind that <a href="http://simplystatistics.org/2013/06/14/the-vast-majority-of-statistical-analysis-is-not-performed-by-statisticians/">the vast majority of data analysis is not done by statisticians</a>, it seems like these little hacks are an important part of science. If you believe in figshare, github, open science, and shareable code, you shouldn&rsquo;t be making fun of the quilt plotters.</p>

<p>Marie Curie says so.</p>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="/2014/01/21/the-johns-hopkins-data-science-specialization-on-coursera/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="/2014/01/21/the-johns-hopkins-data-science-specialization-on-coursera/">The Johns Hopkins Data Science Specialization on Coursera</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="/2014/01/28/swirl-2/">Announcing the Release of swirl 2.0</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="/2014/01/28/swirl-2/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  


</div>

</div>
</div>
<script src="/js/ui.js"></script>
<script src="//yihui.name/js/math-code.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>




</body>
</html>

